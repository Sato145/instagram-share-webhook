# iPhoneショートカット設定ガイド（詳細版）

## 📱 完全ステップバイステップガイド

このガイドでは、iPhoneの共有ボタンからInstagram URLを送信し、Pushover通知を受け取るショートカットを作成します。

---

## 🎯 完成イメージ

### 使用フロー
```
Instagram投稿を開く
  ↓
共有ボタンをタップ
  ↓
「Instagram共有」を選択
  ↓
数秒待つ
  ↓
Pushover通知が届く
  ↓
通知をタップ
  ↓
Xアプリが開く（投稿文が入力済み）
  ↓
投稿ボタンをタップ
```

---

## 📋 事前準備

### 必要なもの
- ✅ iPhone（iOS 14以降）
- ✅ ショートカットアプリ（標準アプリ）
- ✅ Instagramアプリ
- ✅ Pushoverアプリ
- ✅ X（旧Twitter）アプリ
- ✅ Renderサーバーが稼働中

### 確認事項
- ✅ Renderサーバーが正常に動作している
- ✅ Pushover通知が受信できる
- ✅ サービスURL: `https://instagram-share-webhook.onrender.com`

---

## ステップ1: ショートカットアプリを開く（1分）

### 1-1. ホーム画面からショートカットアプリを探す

1. iPhoneのホーム画面を開く

2. 「ショートカット」アプリを探す
   - アイコン: 白地に青とピンクのグラデーション
   - 見つからない場合: App Storeで「ショートカット」を検索してインストール

3. ショートカットアプリをタップして開く

### 1-2. 新規ショートカットを作成

1. 画面右上の「+」ボタンをタップ

2. 空白のショートカット編集画面が表示される

---

## ステップ2: 基本設定（2分）

### 2-1. ショートカット名を設定

1. 画面上部の「新規ショートカット」をタップ

2. ショートカット名を入力:
   ```
   Instagram共有
   ```

3. 「完了」をタップ

### 2-2. アイコンとカラーを設定（オプション）

1. 画面上部のショートカット名の横にある「⋯」（詳細）をタップ

2. 「アイコンとカラー」セクションで:
   - **カラー**: オレンジ
   - **グリフ**: カメラ（📷）

3. 「完了」をタップ

### 2-3. 共有シート設定

1. 画面上部の「⋯」（詳細）をタップ

2. 「共有シートに表示」をONにする
   - スイッチが青色になればOK

3. 「共有シートのタイプ」をタップ

4. 以下を選択:
   - ✅ **URL**（必須）
   - ⬜ その他はすべてOFF

5. 「完了」をタップ

---

## ステップ3: アクション追加（5分）

### 3-1. 辞書アクションを追加

#### 手順:

1. 「アクションを追加」をタップ

2. 検索バーに「辞書」と入力

3. 「辞書」アクションをタップして追加

#### 辞書の設定:

1. 辞書アクションが追加されたら、以下を設定:

   **キー（左側）**: `url`
   - 小文字で入力
   - スペースなし

   **値（右側）**: 「ショートカット入力」を選択
   - 「変数を選択」をタップ
   - 「ショートカット入力」を選択

2. 完成イメージ:
   ```
   ┌─────────────────────────┐
   │ 辞書                    │
   ├─────────────────────────┤
   │ url: ショートカット入力  │
   └─────────────────────────┘
   ```

### 3-2. URLの内容を取得アクションを追加

#### 手順:

1. 辞書アクションの下の「+」ボタンをタップ

2. 検索バーに「URLの内容を取得」と入力

3. 「URLの内容を取得」アクションをタップして追加

#### URLの内容を取得の設定:

1. **URL**フィールドをタップ

2. 以下のURLを入力:
   ```
   https://instagram-share-webhook.onrender.com/webhook
   ```
   - コピー＆ペースト推奨
   - 末尾の `/webhook` を忘れずに

3. **メソッド**をタップ
   - 「GET」から「POST」に変更

4. **ヘッダ**（追加不要）
   - デフォルトのまま

5. **本文を要求**をタップ
   - 「フォーム」から「JSON」に変更

6. **JSON**フィールドをタップ
   - 「変数を選択」をタップ
   - 「辞書」を選択（ステップ3-1で作成したもの）

7. 完成イメージ:
   ```
   ┌─────────────────────────────────────┐
   │ URLの内容を取得                      │
   ├─────────────────────────────────────┤
   │ URL: https://instagram-share-       │
   │      webhook.onrender.com/webhook   │
   │ メソッド: POST                       │
   │ 本文を要求: JSON                     │
   │ 辞書                                 │
   └─────────────────────────────────────┘
   ```

### 3-3. 通知を表示アクションを追加（オプション）

#### 手順:

1. URLの内容を取得アクションの下の「+」ボタンをタップ

2. 検索バーに「通知を表示」と入力

3. 「通知を表示」アクションをタップして追加

#### 通知の設定:

1. テキストフィールドに以下を入力:
   ```
   Instagram投稿を共有しました
   ```

2. 完成イメージ:
   ```
   ┌─────────────────────────────────────┐
   │ 通知を表示                           │
   ├─────────────────────────────────────┤
   │ Instagram投稿を共有しました          │
   └─────────────────────────────────────┘
   ```

---

## ステップ4: 完成確認（1分）

### 4-1. ショートカット全体を確認

完成したショートカットは以下のようになります:

```
┌─────────────────────────────────────┐
│ Instagram共有                        │
├─────────────────────────────────────┤
│                                     │
│ 1. 辞書                             │
│    url: ショートカット入力           │
│                                     │
│ 2. URLの内容を取得                  │
│    URL: https://instagram-share-    │
│         webhook.onrender.com/       │
│         webhook                     │
│    メソッド: POST                    │
│    本文を要求: JSON                  │
│    辞書                              │
│                                     │
│ 3. 通知を表示                        │
│    Instagram投稿を共有しました       │
│                                     │
└─────────────────────────────────────┘
```

### 4-2. 設定を保存

1. 画面右上の「完了」をタップ

2. ショートカット一覧に「Instagram共有」が表示される

---

## ステップ5: テスト実行（3分）

### 5-1. ショートカットを直接実行してテスト

1. ショートカット一覧で「Instagram共有」をタップ

2. テスト用URLを入力:
   ```
   https://www.instagram.com/p/DBkv8YhSsYu/
   ```

3. 「完了」をタップ

4. 数秒待つ

5. 以下を確認:
   - ✅ 「Instagram投稿を共有しました」という通知が表示される
   - ✅ Pushover通知が届く

### 5-2. Instagramアプリから実行してテスト

1. **Instagramアプリ**を開く

2. 任意の投稿を開く
   - 自分の投稿でも他人の投稿でもOK
   - 公開アカウントの投稿を推奨

3. **共有ボタン**（紙飛行機アイコン）をタップ

4. 共有メニューが表示される

5. 下にスクロールして「Instagram共有」を探す
   - 見つからない場合: 「その他」をタップ

6. 「Instagram共有」をタップ

7. 数秒待つ

8. 以下を確認:
   - ✅ 「Instagram投稿を共有しました」という通知が表示される
   - ✅ Pushover通知が届く

### 5-3. Pushover通知を確認

Pushover通知には以下が含まれています:

- **タイトル**: `Instagram 投稿を共有`
- **メッセージ**: 投稿文とURL
- **リンク**: 「Xに投稿する」

### 5-4. X投稿リンクをテスト

1. Pushover通知をタップ

2. 「Xに投稿する」リンクをタップ

3. Xアプリが開く

4. 投稿文が自動入力されている:
   ```
   📷 ユーザー名さんの投稿

   投稿本文...

   https://www.instagram.com/p/xxxxx/

   #Instagram
   ```

5. 投稿ボタンをタップして投稿

---

## 🎉 完成！

これで、iPhoneの共有ボタンからワンタップでInstagram投稿をXに共有できるようになりました！

---

## 🔧 トラブルシューティング

### 問題1: ショートカットが共有シートに表示されない

**原因**: 共有シート設定がOFFになっている

**解決方法**:
1. ショートカット一覧で「Instagram共有」を長押し
2. 「編集」をタップ
3. 右上の「⋯」をタップ
4. 「共有シートに表示」をONにする
5. 「共有シートのタイプ」で「URL」を選択
6. 「完了」をタップ

### 問題2: エラー「URLの内容を取得できませんでした」

**原因1**: URLが間違っている

**解決方法**:
1. ショートカットを編集
2. 「URLの内容を取得」アクションのURLを確認
3. 正しいURL: `https://instagram-share-webhook.onrender.com/webhook`
4. 末尾の `/webhook` があるか確認

**原因2**: Renderサーバーがスリープしている

**解決方法**:
1. ブラウザで以下にアクセス:
   ```
   https://instagram-share-webhook.onrender.com
   ```
2. サーバーが起動するまで待つ（10-30秒）
3. 再度ショートカットを実行

**原因3**: メソッドが「GET」になっている

**解決方法**:
1. ショートカットを編集
2. 「URLの内容を取得」アクションをタップ
3. 「メソッド」を「POST」に変更
4. 「完了」をタップ

### 問題3: Pushover通知が届かない

**原因**: Render環境変数が設定されていない

**解決方法**:
1. https://dashboard.render.com にアクセス
2. `instagram-share-webhook` サービスを選択
3. 「Environment」タブをクリック
4. `PUSHOVER_TOKEN` と `PUSHOVER_USER` が設定されているか確認
5. 設定されていない場合は追加
6. 「Save Changes」をクリック

### 問題4: 「辞書」が見つからない

**原因**: 検索ワードが間違っている

**解決方法**:
1. 「アクションを追加」をタップ
2. 検索バーに「じしょ」または「dictionary」と入力
3. 「辞書」アクションが表示される

### 問題5: 「ショートカット入力」が選択できない

**原因**: 共有シート設定がOFFになっている

**解決方法**:
1. 右上の「⋯」をタップ
2. 「共有シートに表示」をONにする
3. 辞書アクションに戻る
4. 「変数を選択」→「ショートカット入力」が選択可能になる

### 問題6: Instagram情報が取得できない

**原因**: 非公開アカウントの投稿

**解決方法**:
- 公開アカウントの投稿を試す
- 非公開アカウントの場合、基本情報のみ取得されます

---

## 🎨 カスタマイズ

### 通知音を変更

1. ショートカットを編集
2. 「通知を表示」アクションをタップ
3. 「サウンド」を選択
4. 好きな音を選択

### 複数のWebhookサーバーに送信

1. 「URLの内容を取得」アクションを複製
2. 異なるURLを設定
3. 複数のサービスに同時送信可能

### 条件分岐を追加

1. 「if」アクションを追加
2. 条件: URLに「reel」が含まれる
3. リールの場合とそうでない場合で異なる処理

---

## 📱 iOS バージョン別の注意点

### iOS 16以降
- ✅ すべての機能が利用可能
- ✅ 最新のショートカット機能

### iOS 15
- ✅ 基本的な機能は動作
- ⚠️ 一部のアクションが異なる場合あり

### iOS 14
- ✅ 基本的な機能は動作
- ⚠️ 「共有シートのタイプ」の設定方法が異なる場合あり

---

## 💡 使用のヒント

### ヒント1: お気に入りのアカウントをフォロー

よく共有するアカウントをInstagramでフォローしておくと、投稿を見つけやすくなります。

### ヒント2: 投稿文をカスタマイズ

Pushover通知のリンクをタップした後、Xアプリで投稿文を編集できます。

### ヒント3: ハッシュタグを追加

投稿文に追加のハッシュタグを入れたい場合、Xアプリで編集してください。

### ヒント4: 画像を添付

Instagram投稿の画像をXに添付したい場合:
1. Instagram投稿の画像を長押し
2. 「画像を保存」
3. Xアプリで画像を添付

---

## 🔗 関連ドキュメント

- [README.md](README.md) - プロジェクト概要
- [QUICKSTART.md](QUICKSTART.md) - クイックスタート
- [RENDER_DEPLOY.md](RENDER_DEPLOY.md) - Renderデプロイ手順
- [SHORTCUT_SETUP.md](SHORTCUT_SETUP.md) - 簡易版ショートカット設定

---

## 📞 サポート

問題が解決しない場合:

1. Renderログを確認
2. ローカルでテスト実行
3. ショートカットを削除して再作成

---

## 🎉 完成おめでとうございます！

これで、Instagram投稿をワンタップでXに共有できるようになりました。

楽しいSNSライフを！

---

**作成日**: 2026年2月21日  
**バージョン**: 1.0  
**対応iOS**: iOS 14以降
