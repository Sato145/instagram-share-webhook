# iPhoneショートカット設定ガイド

## 📱 ショートカット作成手順

### ステップ1: ショートカットアプリを開く

1. iPhoneで「ショートカット」アプリを開く
2. 右上の「+」ボタンをタップ

### ステップ2: 基本設定

1. 右上の「⋯」（詳細）をタップ

2. 「共有シートに表示」をONにする

3. 「共有シートのタイプ」で以下を選択:
   - ✅ URL

4. 「完了」をタップ

### ステップ3: アクション追加

#### 3-1. 辞書を作成

1. 「アクションを追加」をタップ

2. 検索で「辞書」を検索

3. 「辞書」アクションを追加

4. 辞書の内容:
   - キー: `url`（小文字）
   - 値: 「変数を選択」→「ショートカット入力」

#### 3-2. URLの内容を取得

1. 「+」ボタンをタップ

2. 検索で「URLの内容を取得」を検索

3. 「URLの内容を取得」アクションを追加

4. 設定:
   - **URL**: `https://your-app-name.onrender.com/webhook`
     - ⚠️ `your-app-name` を実際のRenderサービス名に変更
   
   - **メソッド**: `POST`
   
   - **ヘッダ**: （追加不要）
   
   - **本文を要求**: `JSON`
   
   - **辞書**: 「変数を選択」→「辞書」

#### 3-3. 通知を表示（オプション）

1. 「+」ボタンをタップ

2. 検索で「通知を表示」を検索

3. 「通知を表示」アクションを追加

4. テキスト: `Instagram投稿を共有しました`

### ステップ4: ショートカット名を設定

1. 上部の「新規ショートカット」をタップ

2. 名前を入力: `Instagram共有`

3. アイコンを選択（オプション）:
   - 色: オレンジ
   - グリフ: カメラ

4. 「完了」をタップ

## 📸 設定画面のスクリーンショット例

### 基本設定画面
```
┌─────────────────────────┐
│ Instagram共有           │
├─────────────────────────┤
│ 共有シートに表示  [ON]  │
│ 共有シートのタイプ      │
│   ✓ URL                 │
└─────────────────────────┘
```

### アクション画面
```
┌─────────────────────────┐
│ 辞書                    │
│ ┌─────────────────────┐ │
│ │ url: ショートカット  │ │
│ │      入力            │ │
│ └─────────────────────┘ │
└─────────────────────────┘

┌─────────────────────────┐
│ URLの内容を取得         │
│ URL: https://your-app   │
│      .onrender.com/     │
│      webhook            │
│ メソッド: POST          │
│ 本文を要求: JSON        │
│ 辞書                    │
└─────────────────────────┘

┌─────────────────────────┐
│ 通知を表示              │
│ Instagram投稿を共有     │
│ しました                │
└─────────────────────────┘
```

## 🧪 テスト方法

### ステップ1: ショートカットを直接実行

1. ショートカットアプリで「Instagram共有」をタップ

2. テスト用URLを入力:
   ```
   https://www.instagram.com/p/C3xXxXxXxXx/
   ```

3. 「完了」をタップ

4. Pushover通知が届くか確認

### ステップ2: Instagramアプリから実行

1. Instagramアプリを開く

2. 任意の投稿を開く

3. 共有ボタン（紙飛行機アイコン）をタップ

4. 「Instagram共有」を選択

5. Pushover通知が届くか確認

## 🔧 トラブルシューティング

### ショートカットが共有シートに表示されない

**原因**: 「共有シートに表示」がOFFになっている

**解決方法**:
1. ショートカットを開く
2. 右上の「⋯」をタップ
3. 「共有シートに表示」をONにする
4. 「共有シートのタイプ」で「URL」を選択

### エラー: "URLの内容を取得できませんでした"

**原因1**: RenderサービスのURLが間違っている

**解決方法**:
1. Renderダッシュボードでサービス名を確認
2. ショートカットのURLを修正
3. 末尾に `/webhook` があるか確認

**原因2**: Renderサービスがスリープしている

**解決方法**:
1. ブラウザでサービスURLにアクセス
2. サービスが起動するまで待つ（10-30秒）
3. 再度ショートカットを実行

### Pushover通知が届かない

**原因**: Render環境変数が設定されていない

**解決方法**:
1. Renderダッシュボードを開く
2. 「Environment」タブを確認
3. `PUSHOVER_TOKEN` と `PUSHOVER_USER` が設定されているか確認
4. 設定後、サービスを再起動

### Instagram情報が取得できない

**原因**: 非公開アカウントまたはInstagramの仕様変更

**解決方法**:
- 公開アカウントの投稿を試す
- URLが正しいか確認
- Instagramの仕様変更の場合は、アプリの更新を待つ

## 📝 ショートカットのバックアップ

### エクスポート方法

1. ショートカットアプリを開く

2. 「Instagram共有」を長押し

3. 「共有」をタップ

4. 「ファイルに保存」を選択

5. iCloud Driveに保存

### インポート方法

1. 保存したファイルをタップ

2. 「ショートカットを追加」をタップ

## 🎨 カスタマイズ例

### 通知音を変更

1. 「通知を表示」アクションをタップ

2. 「サウンド」を選択

3. 好きな音を選択

### 複数のWebhookサーバーに送信

1. 「URLの内容を取得」アクションを複製

2. 異なるURLを設定

3. 複数のサービスに同時送信可能

### 条件分岐を追加

1. 「if」アクションを追加

2. 条件: URLに「reel」が含まれる

3. リールの場合とそうでない場合で異なる処理

## 📱 iOS バージョン別の注意点

### iOS 16以降

- すべての機能が利用可能

### iOS 15

- 一部のアクションが異なる場合があります
- 基本的な機能は動作します

### iOS 14以前

- 「共有シートのタイプ」の設定方法が異なる場合があります

## 🔗 参考リンク

- [Apple ショートカット ユーザガイド](https://support.apple.com/ja-jp/guide/shortcuts/welcome/ios)
- [Pushover API ドキュメント](https://pushover.net/api)
- [Render ドキュメント](https://render.com/docs)

---

最終更新: 2026年2月21日
